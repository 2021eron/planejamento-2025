<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento 2024-2030 (Online)</title>
     <meta name="color-scheme" content="light dark">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- TELA DE LOGIN -->
    <div id="login-screen">
        <div class="login-box">
            <h2>Acessar Planejamento</h2>
            <form id="login-form">
                <div class="input-group"><label for="username">E-mail</label><input type="email" id="username" required></div>
                <div class="input-group"><label for="password">Senha</label><input type="password" id="password" required></div>
                <button type="submit">Entrar</button><p id="login-error"></p>
            </form>
        </div>
    </div>
    
    <!-- APLICAÇÃO PRINCIPAL -->
    <div id="app-container" class="hidden">
        <div class="container">
            <header>
                <div class="title-container">
                    <div class="title">PLANEJAMENTO</div>
                    <div class="year-selector-group">
                        <label for="year-select" style="font-size: 1.2em; font-weight: bold;">Ano:</label>
                        <select id="year-select">
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                            <option value="2026">2026</option>
                            <option value="2027">2027</option>
                            <option value="2028">2028</option>
                            <option value="2029">2029</option>
                            <option value="2030">2030</option>
                        </select>
                    </div>
                    <div class="header-actions">
                         <button id="change-password-btn">Mudar Senha</button>
                         <button id="logout-btn">Sair</button>
                    </div>
                </div>
                <div class="legend">
                    <div class="legend-item legend-verde">Feriados Nacionais</div>
                    <div class="legend-item legend-laranja">Feriados Estaduais</div>
                    <div class="legend-item legend-amarelo">Emendas</div>
                    <div class="legend-item legend-vermelho">Faltas</div>
                    <div class="legend-item legend-roxo">Afastado</div>
                </div>
            </header>
            
            <div id="view-only-notice" class="hidden">Modo de visualização. As edições estão desativadas.</div>

            <div class="controls-container">
                <div class="employee-controls">
                    <label for="employee-select">Funcionário:</label>
                    <select id="employee-select"></select>
                    <input type="text" id="new-employee-name" placeholder="Nome do novo funcionário">
                    <input type="email" id="new-employee-email" placeholder="E-mail de login do funcionário (opcional)">
                    <button id="add-employee-btn">Adicionar</button>
                    <button id="remove-employee-btn">Remover Selecionado</button>
                </div>
                
                <div class="summary-container">
                    <div class="summary-item"> Folgas Úteis: <span id="summary-uteis">0</span> </div>
                    <div class="summary-item"> Folgas Feriado e FDS: <span id="summary-feriado-fds">0</span> </div>
                    <div class="summary-item summary-total"> <strong>TOTAL FOLGAS:</strong> <strong><span id="summary-total">0</span></strong> </div>
                    <div class="summary-item summary-total"> Horas Extras (Ano): <span id="summary-extras">0</span> </div>
                    <div class="summary-item"> Horas Atraso (Ano): <span id="summary-atrasos">0</span> </div>
                    <div class="summary-item summary-total"> <strong>SALDO DE HORAS:</strong> <strong><span id="summary-saldo">0</span></strong> </div>
                </div>
            </div>
            
            <div id="calendar-container"></div>
        </div>
    </div>

    <!-- MODAL PARA EDITAR O DIA (MODIFICADO) -->
    <div id="day-editor-modal" class="hidden">
        <div class="modal-content">
            <h3 id="modal-title">Editar Dia</h3>
            <div class="modal-input-group">
                <label for="modal-color-select">Status do Dia</label>
                <select id="modal-color-select">
                    <option value="default">Dia Normal</option>
                    <option value="verde">Feriado Nacional</option>
                    <option value="amarelo">Emenda</option>
                    <option value="laranja">Feriado Estadual</option>
                    <option value="vermelho">Falta</option>
                    <option value="roxo">Afastado</option>
                </select>
            </div>
             <!-- GRUPO HORAS EXTRAS COM OBSERVAÇÃO -->
            <div class="modal-input-group modal-input-group-combined">
                <div class="input-item">
                    <label for="modal-extra-hours">Horas Extras</label>
                    <input type="number" id="modal-extra-hours" list="hours-datalist" min="0" step="0.25" placeholder="Ex: 2.5">
                </div>
                <div class="input-item">
                    <label for="modal-extra-hours-obs">Observação</label>
                    <input type="text" id="modal-extra-hours-obs" placeholder="Pequena anotação">
                </div>
            </div>
            <!-- GRUPO HORAS ATRASO COM OBSERVAÇÃO -->
            <div class="modal-input-group modal-input-group-combined">
                <div class="input-item">
                    <label for="modal-late-hours">Horas de Atraso</label>
                    <input type="number" id="modal-late-hours" list="hours-datalist" min="0" step="0.25" placeholder="Ex: 0.5">
                </div>
                <div class="input-item">
                    <label for="modal-late-hours-obs">Observação</label>
                    <input type="text" id="modal-late-hours-obs" placeholder="Pequena anotação">
                </div>
            </div>
            <div class="modal-buttons">
                <button id="modal-cancel-btn">Cancelar</button>
                <button id="modal-save-btn">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- NOVO: ELEMENTO PARA O TOOLTIP DE INFORMAÇÕES -->
    <div id="day-tooltip" class="hidden"></div>

    <datalist id="hours-datalist"></datalist>

    <!-- SCRIPTS DO FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script src="app.js"></script>
</body>
</html>
