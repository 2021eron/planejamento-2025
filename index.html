<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planejamento 2024-2030 (Online)</title>
    <!-- ESTILOS (CSS) -->
    <style>
        :root {
            --cor-fundo: #0b1a33; 
            --cor-principal: #1e3a6b; 
            --cor-destaque: #3b5998;
            --cor-texto: #dfe3ee; 
            --cor-rosa-fds: #fce4e4; 
            --cor-verde: #90ee90;
            
            /* MODIFICADO: Cores ajustadas para melhor visibilidade em modo escuro */
            --cor-amarelo: #FFD700; /* Amarelo Ouro - Mais rico que o puro */
            --cor-laranja: #FF9800; /* Laranja Vibrante */
            --cor-vermelho: #F44336; /* Vermelho Forte */
            
            --cor-roxo: #9370db; 
            --cor-texto-erro: #ffcdd2;
        }
        body { font-family: system-ui, sans-serif; background-color: var(--cor-fundo); color: var(--cor-texto); margin: 0; padding: 0; }
        .hidden { display: none !important; }

        /* ===== ESTILOS DA TELA DE LOGIN ===== */
        #login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--cor-fundo); display: flex; align-items: center; justify-content: center; z-index: 1000;
        }
        .login-box {
            background-color: var(--cor-principal); padding: 40px; border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); width: 100%; max-width: 380px; text-align: center;
        }
        .login-box h2 { margin-top: 0; margin-bottom: 25px; font-size: 1.8em; }
        .login-box .input-group { margin-bottom: 20px; text-align: left; }
        .login-box label { display: block; margin-bottom: 5px; font-weight: bold; }
        .login-box input {
            width: 100%; padding: 12px; border-radius: 5px; border: 1px solid var(--cor-texto);
            font-size: 1em; box-sizing: border-box; background-color: var(--cor-fundo); color: var(--cor-texto);
        }
        .login-box button {
            width: 100%; padding: 12px; border-radius: 5px; border: none; font-size: 1.1em;
            font-weight: bold; cursor: pointer; background-color: var(--cor-destaque); color: white; transition: background-color 0.2s;
        }
        .login-box button:hover { opacity: 0.9; }
        #login-error { color: var(--cor-texto-erro); margin-top: 15px; font-weight: bold; height: 20px; }

        /* ===== ESTILOS DO APP PRINCIPAL ===== */
        #app-container { padding: 15px; }
        .container { max-width: 1400px; margin: auto; }
        header { text-align: center; margin-bottom: 20px; }
        .title-container { display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap; }
        .title { background-color: var(--cor-destaque); padding: 10px 20px; font-size: 2em; font-weight: bold; display: inline-block; border-radius: 8px; border: 2px solid var(--cor-texto); }
        .year-selector-group { display: flex; align-items: center; gap: 10px; }
        #year-select {
            padding: 10px; font-size: 1.2em; font-weight: bold; background-color: var(--cor-fundo); color: var(--cor-texto);
            border: 2px solid var(--cor-texto); border-radius: 8px; cursor: pointer;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        #logout-btn, #change-password-btn {
            background-color: var(--cor-vermelho); color: white;
            border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;
        }
        #change-password-btn {
            background-color: #6c757d;
        }

        .legend { display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; margin: 20px 0; }
        .legend-item { padding: 8px 15px; border-radius: 5px; font-weight: bold; font-size: 0.9em; }
        .legend-verde { background-color: var(--cor-verde); color: black; }
        .legend-laranja { background-color: var(--cor-laranja); color: black; }
        .legend-amarelo { background-color: var(--cor-amarelo); color: black; }
        .legend-vermelho { background-color: var(--cor-vermelho); color: white; }
        .legend-roxo { background-color: var(--cor-roxo); color: white; }
        
        .controls-container {
            display: flex; justify-content: space-between; align-items: flex-start; gap: 20px; margin-bottom: 25px;
            padding: 20px; background-color: var(--cor-principal); border-radius: 8px; flex-wrap: wrap;
        }
        .employee-controls { 
            display: flex; flex-direction: column; align-items: flex-start; gap: 10px; flex: 1; min-width: 280px;
        }
        .employee-controls select:disabled, .employee-controls input:disabled, .employee-controls button:disabled {
            background-color: #555 !important; cursor: not-allowed !important; opacity: 0.6;
        }
        .employee-controls select, .employee-controls input, .employee-controls button { 
            padding: 10px; border-radius: 5px; border: 1px solid var(--cor-texto); font-size: 1em; width: 100%; max-width: 400px; box-sizing: border-box; 
        }
        .employee-controls button { cursor: pointer; background-color: var(--cor-destaque); color: white; font-weight: bold; }
        #new-employee-email { margin-top: 5px; }
        
        .summary-container {
            flex: 1; min-width: 280px; padding: 15px; background-color: var(--cor-destaque); border-radius: 8px; display: flex; flex-direction: column; gap: 8px;
        }
        .summary-item { font-size: 1em; display: flex; justify-content: space-between; align-items: center; }
        .summary-item strong { font-size: 1.1em; }
        .summary-item span { font-weight: bold; background-color: var(--cor-fundo); padding: 2px 8px; border-radius: 4px; min-width: 40px; text-align: center; }
        .summary-total { margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--cor-texto); }
        
        .saldo-positivo { color: var(--cor-verde) !important; }
        .saldo-negativo { color: var(--cor-vermelho) !important; }
        
        #view-only-notice {
            text-align: center; font-weight: bold; color: var(--cor-amarelo);
            background-color: var(--cor-principal); padding: 10px; border-radius: 8px; margin-bottom: 20px;
        }

        #calendar-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
        .month-container { flex: 1 1 300px; min-width: 300px; max-width: 400px; }
        .month-title { text-align: center; font-size: 1.2em; font-weight: bold; color: var(--cor-texto); margin-bottom: 10px; }
        .month-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; }
        .header-cell, .day-cell { display: flex; align-items: center; justify-content: center; padding: 5px; border-radius: 4px; box-sizing: border-box; /* Adicionado para borda funcionar bem */ }
        .header-cell { background-color: var(--cor-principal); font-weight: bold; font-size: 0.8em; }
        .day-cell { background-color: white; color: black; font-size: 0.9em; height: 35px; position: relative; }
        .day-cell.weekend { background-color: var(--cor-rosa-fds); }
        .day-cell.valid-day.editable { cursor: pointer; }
        .day-cell.empty { background-color: transparent; }
        
        /* MODIFICADO: Estilos de cor agora incluem uma borda para melhor destaque */
        .color-verde { background-color: var(--cor-verde) !important; border: 2px solid rgba(255, 255, 255, 0.7); }
        .color-amarelo { background-color: var(--cor-amarelo) !important; color: black !important; border: 2px solid rgba(255, 255, 255, 0.7); }
        .color-laranja { background-color: var(--cor-laranja) !important; color: black !important; border: 2px solid rgba(255, 255, 255, 0.7); }
        .color-vermelho { background-color: var(--cor-vermelho) !important; color: white !important; border: 2px solid rgba(255, 255, 255, 0.7); }
        .color-roxo { background-color: var(--cor-roxo) !important; color: white !important; border: 2px solid rgba(255, 255, 255, 0.7); }

        .day-cell.has-hours::after {
            content: ''; position: absolute; top: 3px; right: 3px;
            width: 6px; height: 6px; background-color: #0b1a33; border-radius: 50%;
        }

        /* ===== ESTILOS DO MODAL DE EDIÇÃO DO DIA ===== */
        #day-editor-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); z-index: 2000;
            display: flex; align-items: center; justify-content: center;
        }
        .modal-content {
            background-color: var(--cor-principal); padding: 25px; border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4); width: 90%; max-width: 400px;
            border: 2px solid var(--cor-destaque);
        }
        .modal-content h3 { margin-top: 0; font-size: 1.5em; text-align: center; }
        .modal-input-group { margin-bottom: 15px; }
        .modal-input-group label { display: block; font-weight: bold; margin-bottom: 8px; }
        .modal-input-group select, .modal-input-group input {
            width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--cor-texto);
            font-size: 1em; box-sizing: border-box; background-color: var(--cor-fundo); color: var(--cor-texto);
        }
        .modal-buttons { display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px; }
        .modal-buttons button {
            padding: 10px 20px; border-radius: 5px; border: none; font-size: 1em;
            font-weight: bold; cursor: pointer; transition: opacity 0.2s;
        }
        .modal-buttons button:hover { opacity: 0.9; }
        #modal-save-btn { background-color: var(--cor-destaque); color: white; }
        #modal-cancel-btn { background-color: #6c757d; color: white; }
    </style>
</head>
<body>

    <!-- TELA DE LOGIN -->
    <div id="login-screen">
        <div class="login-box">
            <h2>Acessar Planejamento</h2>
            <form id="login-form">
                <div class="input-group"><label for="username">E-mail</label><input type="email" id="username" required></div>
                <div class="input-group"><label for="password">Senha</label><input type="password" id="password" required></div>
                <button type="submit">Entrar</button><p id="login-error"></p>
            </form>
        </div>
    </div>
    
    <!-- APLICAÇÃO PRINCIPAL -->
    <div id="app-container" class="hidden">
        <div class="container">
            <header>
                <div class="title-container">
                    <div class="title">PLANEJAMENTO</div>
                    <div class="year-selector-group">
                        <label for="year-select" style="font-size: 1.2em; font-weight: bold;">Ano:</label>
                        <select id="year-select">
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                            <option value="2026">2026</option>
                            <option value="2027">2027</option>
                            <option value="2028">2028</option>
                            <option value="2029">2029</option>
                            <option value="2030">2030</option>
                        </select>
                    </div>
                    <div class="header-actions">
                         <button id="change-password-btn">Mudar Senha</button>
                         <button id="logout-btn">Sair</button>
                    </div>
                </div>
                <div class="legend">
                    <div class="legend-item legend-verde">Feriados Nacionais</div>
                    <div class="legend-item legend-laranja">Feriados Estaduais</div>
                    <div class="legend-item legend-amarelo">Emendas</div>
                    <div class="legend-item legend-vermelho">Faltas</div>
                    <div class="legend-item legend-roxo">Afastado</div>
                </div>
            </header>
            
            <div id="view-only-notice" class="hidden">Modo de visualização. As edições estão desativadas.</div>

            <div class="controls-container">
                <div class="employee-controls">
                    <label for="employee-select">Funcionário:</label>
                    <select id="employee-select"></select>
                    <input type="text" id="new-employee-name" placeholder="Nome do novo funcionário">
                    <input type="email" id="new-employee-email" placeholder="E-mail de login do funcionário (opcional)">
                    <button id="add-employee-btn">Adicionar</button>
                    <button id="remove-employee-btn">Remover Selecionado</button>
                </div>
                
                <div class="summary-container">
                    <div class="summary-item"> Folgas Úteis: <span id="summary-uteis">0</span> </div>
                    <div class="summary-item"> Folgas Feriado e FDS: <span id="summary-feriado-fds">0</span> </div>
                    <div class="summary-item summary-total"> <strong>TOTAL FOLGAS:</strong> <strong><span id="summary-total">0</span></strong> </div>
                    <div class="summary-item summary-total"> Horas Extras (Ano): <span id="summary-extras">0</span> </div>
                    <div class="summary-item"> Horas Atraso (Ano): <span id="summary-atrasos">0</span> </div>
                    <div class="summary-item summary-total"> <strong>SALDO DE HORAS:</strong> <strong><span id="summary-saldo">0</span></strong> </div>
                </div>
            </div>
            
            <div id="calendar-container"></div>
        </div>
    </div>

    <!-- MODAL PARA EDITAR O DIA -->
    <div id="day-editor-modal" class="hidden">
        <div class="modal-content">
            <h3 id="modal-title">Editar Dia</h3>
            <div class="modal-input-group">
                <label for="modal-color-select">Status do Dia</label>
                <select id="modal-color-select">
                    <option value="default">Dia Normal</option>
                    <option value="verde">Feriado Nacional</option>
                    <option value="amarelo">Emenda</option>
                    <option value="laranja">Feriado Estadual</option>
                    <option value="vermelho">Falta</option>
                    <option value="roxo">Afastado</option>
                </select>
            </div>
            <div class="modal-input-group">
                <label for="modal-extra-hours">Horas Extras</label>
                <input type="number" id="modal-extra-hours" list="hours-datalist" min="0" step="0.25" placeholder="Ex: 2.5">
            </div>
            <div class="modal-input-group">
                <label for="modal-late-hours">Horas de Atraso</label>
                <input type="number" id="modal-late-hours" list="hours-datalist" min="0" step="0.25" placeholder="Ex: 0.5">
            </div>
            <div class="modal-buttons">
                <button id="modal-cancel-btn">Cancelar</button>
                <button id="modal-save-btn">Salvar</button>
            </div>
        </div>
    </div>
    
    <datalist id="hours-datalist"></datalist>

    <!-- SCRIPTS DO FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

            <script src="app.js"></script>
</body>
</html>
